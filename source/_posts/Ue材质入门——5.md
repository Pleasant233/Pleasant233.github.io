---
title: 'Ue材质入门——5'
date: '2024-10-22'
description: 虚幻引擎中的渐变实现及其原理概述
top_img: https://pleasant233.oss-cn-beijing.aliyuncs.com/ring-7218706_1920.png
cover: https://pleasant233.oss-cn-beijing.aliyuncs.com/ring-7218706_1920.png
categories: Ue材质入门
---
# 材质中的渐变

* 常用的渐变的分类
	* 方形渐变
	* 中心渐变
	* 角度渐变
* 渐变与UV坐标的关系
	* 在Ue以及其它三维软件中，UV坐标的直观显示是一个由白到黑的颜色渐变，随着数值变化而渐变，因此这种显示方式决定了，我们可以利用它来进行渐变效果的模拟
# 方形渐变

* 方形渐变的拆解：
	* 方形渐变本质上，通过观察我们可以发现，实际上它就是两个方向渐变的叠加：
	* ![未标题-1.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/%E6%9C%AA%E6%A0%87%E9%A2%98-1.png)
	* 实际上我们可以通过从水平方向和竖直方向分别拆解这个渐变，它是由白（1）到黑（0）再到白（1）的过程，那么我们只需要让它的数值变化符合这个规律，并且在最后取其中的最小值即可完成上图效果的实现：
* 详细实现过程（UE）
* 首先，我们需要进行的是第一部，UV坐标的分解和处理，当然，我们同样可以对二维数据同时处理，我们先考虑第二种：
* 创建UV节点（U+左键）并且创建一个Mask掩码节点，用于分离UV常量：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008100813.png)
* 随后，我们根据拆解的分析，利用subtract节点，将数值范围调整为：-0.5,0,0.5，之后，我们利用绝对值节点ABS将数值取正，调整为0.5,0,0.5,再乘2，即可达成1,0,1的数值变化：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008101232.png)

* 但这时你若直接输出，则会发现它与我们的期待正好相反，我们所需要的是0，1，0，但现在是1,0,1，不用担心，我们只需将其取反，利用取反节点onesubx（1-x）即可将数值变化变为0,1,0：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008101422.png)
* 数值满足了，但此时若直接输出会发现，依然不是我们所需要的效果，这是为何呢？
* 原来实际上我们同时处理UV的代价就是它们是混合进行的，所以若想达到效果，就需要将混合去除，
* 我们同样利用掩码Mask节点，分离UV方向，然后做最后一步，那么就是按我们的需求混合，我们希望保留下黑色部分，黑色部分是0，也就是最小值min，因此我们需要利用最小值节点min，以此来获得最终图像的效果：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008101750.png)
* 这样我们的方形渐变就大功告成了！

* **一些思考**：
	* 既然它是一个效果材质，那么我们理应提供调节效果的手段，我们在目前先提供一个控制范围的参数，若想控制渐变的区域，我们可以利用之前学过的Power节点，让整体数值趋于0，这样我们就可以将渐变范围调整了：
	* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008102405.png)
	* 其他的调整方式，也欢迎大家实践！
# 中心渐变

* 下面我们再来看一个类型，中心渐变
* 中心渐变的拆解：
	* 中心渐变是一个圆形，从中心向外变化，内部为0，最外部为1，常常用来作为相机晕影的效果出现
	* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008102703.png)
	* 实际上，它是一个特殊的方形渐变，它是365°的方向上变化的方形渐变，正如圆本身是一个很多边的多边形一样。因此，我们可以用类似的思考方式去模拟：
* 详细实现过程（UE）：
* 首先，同样我们需要创建一个UV节点，但与上面条件不同的是，我们需要利用另一个节点来完成对全部方向上渐变的计算，我们使用Distance节点，它可以测量输入值与一个接收的数值的距离，我们将其设定为0.5,0.5,也就是正中心的UV坐标，我们就可以的到一个很棒的效果，一个看起来不错的圆形渐变：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008103405.png)
* 但仔细观察你会发现，它有些暗，是的，它的变化范围并不是0-1而是0-0.75，这是为什么呢，根据简单的勾股定理计算，实际上斜边并没有到1，因此为了让它的范围正确，我们需要进行一系列调整，首先，利用乘法节点，将其范围增大到1以上，接着在利用subtract节点规范它的范围到0-1之间：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008103621.png)
* 我们可以肉眼直观地看到它的变化，接下来，我们依然要解决它数值相反的问题，所以使用1-x节点，调整它的数值范围，最后得到正确的效果。
* 我们可以利用我们得到的效果，制作一个晕影图片！
* 导入一张外部贴图，连接到一个新建的乘法节点上，并将1-x节点的输出连到这个乘法节点上：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008104047.png)
*  **同样的**，我们也可以对其增加一些外部数据调整的节点，让这个材质更加具备一个材质应该有的属性！

# 角度渐变

* 接下来是一个小难点，角度渐变
* 角度渐变的分析拆解：
	* 角度渐变实际上是根据角度的变化，渐变的颜色逐渐变化，也就是在一个圆（2π）的变化范围内，数据从0-1变化的过程，本质上与前两个渐变没有区别，难点在于它涉及到了一定的三角函数运算：
	* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008104626.png)
	* 不过我们依然可以对其进行分析，只要细心拆解，就不会有无法实现的效果，本篇略长，希望大家耐心学习，争取有所收获
* 角度渐变的实现(UE):
* 首先，万变不离其宗，我们依然创建UV节点，同时分离UV方向，当然你也可以尝试不分离，并思考其中的关系，我们这里使用掩码Mask节点来分离UV：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008105251.png)
* 不同的是，我们需要对UV坐标进行数值上的调整，之前的调整方式有些麻烦了，我们可以通过一个高级节点来简化这个过程，但本质依旧还是一样的，只不过是一个上层的封装罢了：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008105422.png)
* 这个节点可以接受四个数值，分别是原始的minMax值，和想要转换的max和min值，就可以将其变为对应数值范围的数据，随后，我们将其分别输出到一个关键节点arctan节点，它是我们实现这个效果的关键，从数学角度分析如下图：
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008115714.png)
* 因此，我们得到的范围为从-π/4到π/4，也就是能看到的变化范围为45°,但实际上，ue中颜色变化范围是0-1，而45°还未达到上限，因此实际上我们看见的结果并非45度，而我们可以通过除法变化该图像范围
* ![image.png](https://pleasant233.oss-cn-beijing.aliyuncs.com/20241008141113.png)
* 该图实际显示的其实是-π到π，但实际上是0到2π所以如果我们将整个结果同时除以2π，最后我们将得到一个0-1范围的变化，而如果我们除以π，则是-1到0，0到1的变化，这里ue改变了原本数学的值域范围将它变为了-π到π的显示，而实际数值计算中却有所不同
---
